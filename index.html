<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>算利息</title>
		<style type="text/css">
			body {
				line-height: 30px;
				padding: 10px;
			}
		</style>
	</head>
	<body>
	</body>
	<script type="text/javascript">
		function sum(arr) {
			let info = '',
				money = 0,
				sumMoney = 0
			const end = new Date().getTime(),
				 day = 60 * 60 * 24 * 1000
			arr.forEach(item => {
				const start = new Date(item.date + ' 00:00').getTime()
				const n = Math.ceil((end > start ? end - start : 0) / day)
				sumMoney += n * item.price
				const today = {}
				if (item.price > 0) {
					today.value = '借'
					today.date = item.date
				} else {
					today.value = '还'
					today.date = getLocalTime(start)
				}
				info += `${today.date} 日 ${today.value} 了 ${ Math.abs(item.price) / 3} 万元，当前借款数：${money += item.price / 3} 万元 <br />`
			})
			const n = data.reduce((total, item) => {
				if (typeof total === 'object') {
					total = total.price
				}
				return total + item.price
			}, 0)
			info += `共借 ${n / 3}万，总利息 ${sumMoney}元`
			return info
		}
		
		function getLocalTime(nS, minusDay = 1) {
			const date = new Date(parseInt(nS) - minusDay * 24 * 60 * 60 * 1000).toLocaleString().split('上午')[0]
		   return date.replace(/\//g, '-')
		}
		
		var data = [{
			date: '2020-03-08',
			price: 9
		}, {
			date: '2020-03-25',
			price: 3
		}, {
			date: '2020-04-15',
			price: 3
		}, {
			date: '2020-04-25',
			price: 3
		}, {
			date: '2020-05-02',
			price: -6
		}, {
			date: '2020-05-14',
			price: 3
		}, {
			date: '2020-05-15',
			price: 3
		}, {
			date: '2020-07-04',
			price: -3
		}, {
			date: '2020-07-20',
			price: 3
		}, {
			date: '2020-08-01',
			price: 15
		}, {
			date: '2020-08-08',
			price: -6
		}, {
			date: '2020-08-21',
			price: 3
		}, {
			date: '2020-08-30',
			price: 3
		}, {
			date: '2020-09-02',
			price: -6
		}, {
			date: '2020-09-03',
			price: -3
		}, {
			date: '2020-09-04',
			price: -3
		}, {
			date: '2020-09-10',
			price: 19.5
		}, {
			date: '2020-09-20',
			price: -6
		}, {
			date: '2020-09-21',
			price: -6
		}, {
			date: '2020-10-01',
			price: -6
		}, {
			date: '2020-10-02',
			price: -6
		}, {
			date: '2020-10-03',
			price: -6
		}, {
			date: '2020-10-07',
			price: -3
		}, {
			date: '2020-10-15',
			price: 3
		}, {
			date: '2020-10-20',
			price: 4.5
		}, {
			date: '2020-10-28',
			price: -3
		}, {
			date: '2020-11-15',
			price: 3
		}, {
			date: '2020-11-16',
			price: 3
		}, {
			date: '2020-11-21',
			price: 3
		}, {
			date: '2020-11-29',
			price: 3
		}, {
			date: '2020-12-10',
			price: -6
		}]
		data = [{
			date: '2021-2-10',
			price: 3
		}]
		document.write(sum(data))	</script>
</html>
